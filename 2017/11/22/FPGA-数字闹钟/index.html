<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">

  <!-- PACE Progress Bar START -->
  
    <script src="/js/pace.min.js"></script>
    <link rel="stylesheet" href="https://github.com/HubSpot/pace/raw/master/themes/orange/pace-theme-flash.css">
  
  

  <!-- PACE Progress Bar START -->

  
  <title>fpga.数字闹钟 | luheng&#39;s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
    <meta name="keywords" content="fpga，数字闹钟,top" />
  
  
  
  
  <meta name="description" content="用FPGA设计一个数字闹钟应该说是一个比较综合的小系统，包含了按键、数码管、状态机等内容，本文主要是讲述三键输入的数字闹钟总体的设计，整个作品和小时候两三块一个的电子手表十分类似。下面具体讲解…">
<meta name="keywords" content="fpga，数字闹钟,top">
<meta property="og:type" content="article">
<meta property="og:title" content="FPGA.数字闹钟">
<meta property="og:url" content="http://www.luheng.online/2017/11/22/FPGA-数字闹钟/index.html">
<meta property="og:site_name" content="luheng&#39;s blog">
<meta property="og:description" content="用FPGA设计一个数字闹钟应该说是一个比较综合的小系统，包含了按键、数码管、状态机等内容，本文主要是讲述三键输入的数字闹钟总体的设计，整个作品和小时候两三块一个的电子手表十分类似。下面具体讲解…">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://raw.githubusercontent.com/sirlh/photo/6b671c329f8f471b8058a5d4bd6c552dcb525c95/FPGA/assignment/top/all.PNG">
<meta property="og:updated_time" content="2018-01-10T09:26:14.394Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="FPGA.数字闹钟">
<meta name="twitter:description" content="用FPGA设计一个数字闹钟应该说是一个比较综合的小系统，包含了按键、数码管、状态机等内容，本文主要是讲述三键输入的数字闹钟总体的设计，整个作品和小时候两三块一个的电子手表十分类似。下面具体讲解…">
<meta name="twitter:image" content="https://raw.githubusercontent.com/sirlh/photo/6b671c329f8f471b8058a5d4bd6c552dcb525c95/FPGA/assignment/top/all.PNG">
  
  <link rel="icon" href="/css/images/favicon.ico">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Montserrat:700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic" rel="stylesheet" type="text/css">
  <link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
  <style type="text/css">
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/9749f0/00000000000000000001008f/27/l?subset_id=2&fvd=n5) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/90cf9f/000000000000000000010091/27/l?subset_id=2&fvd=n7) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/8a5494/000000000000000000013365/27/l?subset_id=2&fvd=n4) format("woff2");font-weight:lighter;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/d337d8/000000000000000000010095/27/l?subset_id=2&fvd=i4) format("woff2");font-weight:400;font-style:italic;}</style>
    
  <link rel="stylesheet" id="athemes-headings-fonts-css" href="//fonts.googleapis.com/css?family=Yanone+Kaffeesatz%3A200%2C300%2C400%2C700&amp;ver=4.6.1" type="text/css" media="all">
  <link rel="stylesheet" href="/css/style.css">

  <script src="/js/jquery-3.1.1.min.js"></script>

  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="/css/bootstrap.css" >
  <link rel="stylesheet" href="/css/hiero.css" >
  <link rel="stylesheet" href="/css/glyphs.css" >
  
    <link rel="stylesheet" href="/css/vdonate.css" >
  

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/css/my.css">
  <!-- Google Adsense -->
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
      (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-0123456789ABCDEF",
          enable_page_level_ads: true
      });
  </script>
</head>

<script>
var themeMenus = {};

  themeMenus["/"] = "首页"; 

  themeMenus["/archives"] = "归档"; 

  themeMenus["/tags"] = "标签"; 

  themeMenus["/about"] = "关于"; 

  themeMenus["/guestbook"] = "留言"; 

  themeMenus["/atom.xml"] = "rss"; 

</script>


  <body data-spy="scroll" data-target="#toc" data-offset="50">


  <header id="allheader" class="site-header" role="banner">
  <div class="clearfix container">
      <div class="site-branding">

          <h1 class="site-title">
            
              <a href="/" title="luheng&#39;s blog" rel="home"> luheng&#39;s blog </a>
            
          </h1>

          
            
          <nav id="main-navigation" class="main-navigation" role="navigation">
            <a class="nav-open">Menu</a>
            <a class="nav-close">Close</a>
            <div class="clearfix sf-menu">

              <ul id="main-nav" class="nmenu sf-js-enabled">
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/">首页</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/archives">归档</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/tags">标签</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/about">关于</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/guestbook">留言</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/atom.xml">rss</a> </li>
                    
              </ul>
            </div>
          </nav>


      </div>
  </div>
</header>


  <div id="originBgDiv" style="background: #fff; width: 100%;">

      <div style="max-height:600px; overflow: hidden;  display: flex; display: -webkit-flex; align-items: center;">
        <img id="originBg" width="100%" alt="" src="">
      </div>

  </div>

  <script>
  function setAboutIMG(){
      var imgUrls = "css/images/pose.jpg,https://source.unsplash.com/collection/954550/1920x1080".split(",");
      var random = Math.floor((Math.random() * imgUrls.length ));
      if (imgUrls[random].startsWith('http') || imgUrls[random].indexOf('://') >= 0) {
        document.getElementById("originBg").src=imgUrls[random];
      } else {
        document.getElementById("originBg").src='/' + imgUrls[random];
      }
  }
  bgDiv=document.getElementById("originBgDiv");
  if(location.pathname.match('about')){
    setAboutIMG();
    bgDiv.style.display='block';
  }else{
    bgDiv.style.display='none';
  }
  </script>



  <div id="container">
    <div id="wrap">
            
      <div id="content" class="outer">
        
          <section id="main" style="float:none;"><article id="post-FPGA-数字闹钟" style="width: 66%; float:left;" class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" class="article-title" itemprop="name">
      FPGA.数字闹钟
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/2017/11/22/FPGA-数字闹钟/" class="article-date">
	  <time datetime="2017-11-22T13:28:09.000Z" itemprop="datePublished">十一月 22, 2017</time>
	</a>

      
	<span id="busuanzi_container_page_pv">
	  本文总阅读量<span id="busuanzi_value_page_pv"></span>次
	</span>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>用FPGA设计一个数字闹钟应该说是一个比较综合的小系统，包含了按键、数码管、状态机等内容，本文主要是讲述三键输入的数字闹钟总体的设计，整个作品和小时候两三块一个的电子手表十分类似。下面具体讲解…<br><a id="more"></a></p>
<h2 id="功能描述"><a href="#功能描述" class="headerlink" title="功能描述"></a>功能描述</h2><blockquote>
<p>1  用四个数码管正常显示时、分高低位，实现正常显示时间。<br>2  具备调分调时功能<br>3  闹钟功能</p>
</blockquote>
<p>功能并不复杂，我们现在来分析一下需要哪些模块。<br>首先是时钟功能，正常显示时间肯定是必须的，为实现这一可以设计一个60进制计数器和一个24进制计数器，当然也可以根据逻辑直接书写出来，但无论是什么办法，这肯定需要一个模块来实现它。</p>
<p>第二就是调分调时了，说白了就是置数，要置数，那么就必须有一个区域去控制数据，也需要一个地方存储数据，然后将置数的数据传给时钟，所以它应该与键盘的联系，内部有存储器。</p>
<p>第三是闹钟，闹钟不难想，比较器，我设定闹钟时间，然后与时钟的时间比较，如果两者相同，输出闹钟信号，就是如此。</p>
<p>最后的便是显示电路，主要是数码管的显示原理，驱动数码管显示时间。</p>
<p>就是这几样部分，貌似这么一说，确实没有什么东西，一个系统就是需要输入和输出相互协调好，这里面的逻辑必须是相互对应的，不出矛盾，个人认为，这是设计的难度所在。</p>
<h2 id="整体设计图"><a href="#整体设计图" class="headerlink" title="整体设计图"></a>整体设计图</h2><p><img src="https://raw.githubusercontent.com/sirlh/photo/6b671c329f8f471b8058a5d4bd6c552dcb525c95/FPGA/assignment/top/all.PNG" alt=""></p>
<h2 id="模块讲解"><a href="#模块讲解" class="headerlink" title="模块讲解"></a>模块讲解</h2><h3 id="键盘模块（key）"><a href="#键盘模块（key）" class="headerlink" title="键盘模块（key）"></a>键盘模块（key）</h3><table>
<thead>
<tr>
<th>输入</th>
<th style="text-align:left">功能说明</th>
<th style="text-align:center">输出</th>
<th style="text-align:center">功能说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>add_in</td>
<td style="text-align:left">加</td>
<td style="text-align:center">c_add</td>
<td style="text-align:center">时钟加</td>
</tr>
<tr>
<td>aub_in</td>
<td style="text-align:left">减</td>
<td style="text-align:center">c_sub</td>
<td style="text-align:center">时钟减</td>
</tr>
<tr>
<td>model_in</td>
<td style="text-align:left">模式控制端</td>
<td style="text-align:center">a_hour</td>
<td style="text-align:center">调闹钟小时</td>
</tr>
<tr>
<td>clk</td>
<td style="text-align:left">时钟</td>
<td style="text-align:center">a_minute</td>
<td style="text-align:center">调闹钟分钟</td>
</tr>
<tr>
<td>rst_n</td>
<td style="text-align:left">复位</td>
<td style="text-align:center">cnt_control</td>
<td style="text-align:center">计数器开关</td>
</tr>
<tr>
<td></td>
<td style="text-align:left"></td>
<td style="text-align:center">Display_Model</td>
<td style="text-align:center">显示控制</td>
</tr>
<tr>
<td></td>
<td style="text-align:left"></td>
<td style="text-align:center">Time_model</td>
<td style="text-align:center">调时钟转换信号</td>
</tr>
</tbody>
</table>
<h4 id="细节讲解"><a href="#细节讲解" class="headerlink" title="细节讲解"></a>细节讲解</h4><blockquote>
<p><strong>model:模式的选择寄存器</strong></p>
</blockquote>
<p>整个闹钟系统我设置为五个模式，所以model需要是三位的[2:0]<br>00:时钟正常走时<br>01：时钟调分模式，该模式下时钟的计数器停止，时钟是不走的，同时显示模式也会转到调时钟模式。<br>10：时钟调时模式，与调分模式类似。<br>11：闹钟调分设置模式，此时时钟走时，显示模式为闹钟模式。</p>
<p>100：闹钟调时模式，与调分时类似。</p>
<blockquote>
<p><strong>cnt_control:计数器开关</strong></p>
</blockquote>
<p>正常走时和调闹钟模式下，计数器开，cnt_control = 0;<br>当进入调分和调时模式，计数器关闭，cnt_control = 1。</p>
<blockquote>
<p><strong>Time_Model:调时钟转换信号</strong></p>
</blockquote>
<p>这个是连接时钟模块（clock）的，是调分模式和调时模式的切换信号。</p>
<blockquote>
<p><strong>Display_Model:显示控制</strong></p>
</blockquote>
<p>正常走时，进入调分和调时模式时，停止走时，整个过程我设置为同一种显示模式；<br>闹钟模式下，显示模式转换；<br>所以一共是两种模式，一根线足以。</p>
<h4 id="代码展示"><a href="#代码展示" class="headerlink" title="代码展示"></a>代码展示</h4><p><style><br>.testButton { color:black;font-size:12px;padding-top:10px;padding-bottom:10px;padding-left:25px;padding-right:25px;border-width:;border-color:white;border-style:;border-radius:10px;background-color:#f3f3f3;}.testButton:hover{color:white;background-color:#0684bd;border-color:#87daff;}<br></style></p>
<p><button class="testButton" onclick="document.all.child1.style.display=(document.all.child1.style.display =='none')?'':'none'">点击显\隐代码</button></p>
<div id="child1" style="display:"><br><br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> key(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> rst_n,</span><br><span class="line">    <span class="keyword">input</span> add_in,<span class="comment">//增加按钮</span></span><br><span class="line">    <span class="keyword">input</span> sub_in,<span class="comment">//减去按钮</span></span><br><span class="line">    <span class="keyword">input</span> model_in,<span class="comment">//模式选择</span></span><br><span class="line">                </span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> Display_Model, </span><br><span class="line">      <span class="comment">//时钟与闹钟显示选择，0 代表时钟，1代表闹钟</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> cnt_control, <span class="comment">//控制定时器</span></span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> [<span class="number">2</span>:<span class="number">0</span>]Time_model,    </span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> c_add,       <span class="comment">//控制时钟 加</span></span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> c_sub,		<span class="comment">//控制时钟 减</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> a_add,       <span class="comment">//控制闹钟 加</span></span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> a_sub       <span class="comment">//控制闹钟  减</span></span><br><span class="line">            );</span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line"><span class="comment">/************************************/</span></span><br><span class="line"><span class="keyword">parameter</span> T40MS = <span class="number">20'd40_000</span>;</span><br><span class="line"><span class="keyword">parameter</span> T1S = <span class="number">30'd1_000_000</span>;</span><br><span class="line"><span class="comment">/************************************/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">///         add_in 按键      /////</span></span><br><span class="line"><span class="keyword">reg</span> add;</span><br><span class="line"><span class="keyword">reg</span> [<span class="number">19</span>:<span class="number">0</span>]cnt_a;</span><br><span class="line"><span class="keyword">reg</span> [<span class="number">1</span>:<span class="number">0</span>]a;</span><br><span class="line"> <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk <span class="keyword">or</span> <span class="keyword">negedge</span> rst_n)       </span><br><span class="line">   <span class="keyword">begin</span></span><br><span class="line">       <span class="keyword">if</span>(!rst_n)</span><br><span class="line">           <span class="keyword">begin</span></span><br><span class="line">               cnt_a &lt;= <span class="number">0</span>;</span><br><span class="line">               a &lt;= <span class="number">0</span>;</span><br><span class="line">               add &lt;= <span class="number">1</span>; </span><br><span class="line">           <span class="keyword">end</span></span><br><span class="line">       <span class="keyword">else</span></span><br><span class="line">       <span class="keyword">begin</span></span><br><span class="line">           <span class="keyword">case</span>(a) </span><br><span class="line">               <span class="number">0</span>:<span class="keyword">begin</span></span><br><span class="line">                   <span class="keyword">if</span>(cnt_a &lt; T40MS)</span><br><span class="line">                     <span class="comment">// 按下时间大于40MS 认为有效</span></span><br><span class="line">                       <span class="keyword">begin</span></span><br><span class="line">                           <span class="keyword">if</span>(!add_in) </span><br><span class="line">                               cnt_a = cnt_a+<span class="number">1'b1</span>;</span><br><span class="line">                           <span class="keyword">else</span></span><br><span class="line">                               cnt_a = <span class="number">0</span>;</span><br><span class="line">                         <span class="keyword">end</span></span><br><span class="line">                   <span class="keyword">else</span> <span class="comment">//counter&gt; 40MS ，说明确实按键是按下了</span></span><br><span class="line">                         <span class="keyword">begin</span> </span><br><span class="line">                               add = <span class="number">0</span>; </span><br><span class="line">                           <span class="comment">// 给冲击信号 ，0~1 是上升沿</span></span><br><span class="line">                               a = <span class="number">1</span>;  </span><br><span class="line">                           <span class="comment">//确定按键按下，转到状态 1</span></span><br><span class="line">                               cnt_a = <span class="number">0</span>;  <span class="comment">//计数器清零</span></span><br><span class="line">                         <span class="keyword">end</span></span><br><span class="line">                     <span class="keyword">end</span></span><br><span class="line">                <span class="number">1</span>:<span class="keyword">begin</span></span><br><span class="line">                       add = <span class="number">1</span>;    <span class="comment">//产生尖脉冲</span></span><br><span class="line">                       <span class="keyword">if</span>(cnt_a &lt; T40MS) </span><br><span class="line">                         <span class="comment">// 按下时间大于40MS 松开有效</span></span><br><span class="line">                           <span class="keyword">begin</span></span><br><span class="line">                               <span class="keyword">if</span>(add_in) </span><br><span class="line">                                       cnt_a = cnt_a+<span class="number">1'b1</span>;</span><br><span class="line">                               <span class="keyword">else</span></span><br><span class="line">                                       cnt_a = <span class="number">0</span>; </span><br><span class="line">                             <span class="keyword">end</span></span><br><span class="line">                        <span class="keyword">else</span></span><br><span class="line">                            <span class="keyword">begin</span></span><br><span class="line">                               a = <span class="number">0</span>; </span><br><span class="line">                    <span class="comment">// 若松开，回到状态 0 ，等待下次按键到来</span></span><br><span class="line">                               cnt_a = <span class="number">0</span>;</span><br><span class="line">                            <span class="keyword">end</span></span><br><span class="line">                   <span class="keyword">end</span></span><br><span class="line">                   <span class="keyword">default</span> : a = <span class="number">1</span>; </span><br><span class="line">           <span class="keyword">endcase</span></span><br><span class="line">       <span class="keyword">end</span></span><br><span class="line">   <span class="keyword">end</span></span><br><span class="line"><span class="comment">//////////////////////////////////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="comment">///        sub_in 按键       ///</span></span><br><span class="line"><span class="keyword">reg</span> sub;</span><br><span class="line"><span class="keyword">reg</span> [<span class="number">19</span>:<span class="number">0</span>]cnt_s;</span><br><span class="line"><span class="keyword">reg</span> [<span class="number">1</span>:<span class="number">0</span>]s;</span><br><span class="line"> <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk <span class="keyword">or</span> <span class="keyword">negedge</span> rst_n)       </span><br><span class="line">   <span class="keyword">begin</span></span><br><span class="line">       <span class="keyword">if</span>(!rst_n)</span><br><span class="line">           <span class="keyword">begin</span></span><br><span class="line">               cnt_s &lt;= <span class="number">0</span>;</span><br><span class="line">               s &lt;= <span class="number">0</span>;</span><br><span class="line">               sub &lt;= <span class="number">1</span>; </span><br><span class="line">           <span class="keyword">end</span></span><br><span class="line">       <span class="keyword">else</span></span><br><span class="line">       <span class="keyword">begin</span></span><br><span class="line">           <span class="keyword">case</span>(s) </span><br><span class="line">               <span class="number">0</span>:<span class="keyword">begin</span></span><br><span class="line">                   <span class="keyword">if</span>(cnt_s &lt; T40MS)</span><br><span class="line">                     <span class="comment">// 按下时间大于40MS 认为有效</span></span><br><span class="line">                       <span class="keyword">begin</span></span><br><span class="line">                           <span class="keyword">if</span>(!sub_in) </span><br><span class="line">                               cnt_s = cnt_s+<span class="number">1'b1</span>;</span><br><span class="line">                           <span class="keyword">else</span></span><br><span class="line">                               cnt_s = <span class="number">0</span>;</span><br><span class="line">                         <span class="keyword">end</span></span><br><span class="line">                   <span class="keyword">else</span> <span class="comment">//counter&gt; 40MS ，说明确实按键是按下了</span></span><br><span class="line">                         <span class="keyword">begin</span> </span><br><span class="line">                               sub = <span class="number">0</span>; </span><br><span class="line">                           <span class="comment">// 给冲击信号 ，0~1 是上升沿</span></span><br><span class="line">                               s = <span class="number">1</span>; </span><br><span class="line">                           <span class="comment">//确定按键按下，转到状态 1</span></span><br><span class="line">                               cnt_s = <span class="number">0</span>;  <span class="comment">//计数器清零</span></span><br><span class="line">                         <span class="keyword">end</span></span><br><span class="line">                     <span class="keyword">end</span></span><br><span class="line">                <span class="number">1</span>:<span class="keyword">begin</span></span><br><span class="line">                       sub = <span class="number">1</span>;    <span class="comment">//产生尖脉冲</span></span><br><span class="line">                       <span class="keyword">if</span>(cnt_s &lt; T40MS) </span><br><span class="line">                         <span class="comment">// 按下时间大于40MS 松开有效</span></span><br><span class="line">                           <span class="keyword">begin</span></span><br><span class="line">                               <span class="keyword">if</span>(sub_in) </span><br><span class="line">                                       cnt_s = cnt_s+<span class="number">1'b1</span>;</span><br><span class="line">                               <span class="keyword">else</span></span><br><span class="line">                                       cnt_s = <span class="number">0</span>; </span><br><span class="line">                             <span class="keyword">end</span></span><br><span class="line">                        <span class="keyword">else</span></span><br><span class="line">                            <span class="keyword">begin</span></span><br><span class="line">                               s = <span class="number">0</span>; </span><br><span class="line">                         <span class="comment">// 若松开，回到状态 0 ，等待下次按键到来</span></span><br><span class="line">                               cnt_s = <span class="number">0</span>;</span><br><span class="line">                            <span class="keyword">end</span></span><br><span class="line">                   <span class="keyword">end</span></span><br><span class="line">                   <span class="keyword">default</span> : s = <span class="number">1</span>; </span><br><span class="line">           <span class="keyword">endcase</span></span><br><span class="line">       <span class="keyword">end</span></span><br><span class="line">   <span class="keyword">end</span></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////</span></span><br><span class="line">      </span><br><span class="line"><span class="comment">///        model_in 按键       ///</span></span><br><span class="line"><span class="keyword">reg</span> model;</span><br><span class="line"><span class="keyword">reg</span> [<span class="number">19</span>:<span class="number">0</span>]cnt_m;</span><br><span class="line"><span class="keyword">reg</span> [<span class="number">1</span>:<span class="number">0</span>]m;</span><br><span class="line"> <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk <span class="keyword">or</span> <span class="keyword">negedge</span> rst_n)       </span><br><span class="line">   <span class="keyword">begin</span></span><br><span class="line">       <span class="keyword">if</span>(!rst_n)</span><br><span class="line">           <span class="keyword">begin</span></span><br><span class="line">               cnt_m &lt;= <span class="number">0</span>;</span><br><span class="line">               m &lt;= <span class="number">0</span>;</span><br><span class="line">               model &lt;= <span class="number">1</span>; </span><br><span class="line">           <span class="keyword">end</span></span><br><span class="line">       <span class="keyword">else</span></span><br><span class="line">       <span class="keyword">begin</span></span><br><span class="line">           <span class="keyword">case</span>(m) </span><br><span class="line">               <span class="number">0</span>:<span class="keyword">begin</span></span><br><span class="line">                   <span class="keyword">if</span>(cnt_m &lt; T40MS) </span><br><span class="line">                     <span class="comment">// 按下时间大于40MS 认为有效</span></span><br><span class="line">                       <span class="keyword">begin</span></span><br><span class="line">                           <span class="keyword">if</span>(!model_in) </span><br><span class="line">                               cnt_m = cnt_m+<span class="number">1'b1</span>;</span><br><span class="line">                           <span class="keyword">else</span></span><br><span class="line">                               cnt_m = <span class="number">0</span>;</span><br><span class="line">                         <span class="keyword">end</span></span><br><span class="line">                   <span class="keyword">else</span> <span class="comment">//counter&gt; 40MS ，说明确实按键是按下了</span></span><br><span class="line">                         <span class="keyword">begin</span> </span><br><span class="line">                               model = <span class="number">0</span>; </span><br><span class="line">                           <span class="comment">// 给冲击信号 ，0~1 是上升沿</span></span><br><span class="line">                               m = <span class="number">1</span>;   </span><br><span class="line">                           <span class="comment">//确定按键按下，转到状态 1</span></span><br><span class="line">                               cnt_m = <span class="number">0</span>;  <span class="comment">//计数器清零</span></span><br><span class="line">                         <span class="keyword">end</span></span><br><span class="line">                     <span class="keyword">end</span></span><br><span class="line">                <span class="number">1</span>:<span class="keyword">begin</span></span><br><span class="line">                       model = <span class="number">1</span>;    <span class="comment">//产生尖脉冲</span></span><br><span class="line">                       <span class="keyword">if</span>(cnt_m &lt; T40MS)</span><br><span class="line">                         <span class="comment">// 按下时间大于40MS 松开有效</span></span><br><span class="line">                           <span class="keyword">begin</span></span><br><span class="line">                               <span class="keyword">if</span>(model_in) </span><br><span class="line">                                       cnt_m = cnt_m+<span class="number">1'b1</span>;</span><br><span class="line">                               <span class="keyword">else</span></span><br><span class="line">                                       cnt_m = <span class="number">0</span>; </span><br><span class="line">                             <span class="keyword">end</span></span><br><span class="line">                        <span class="keyword">else</span></span><br><span class="line">                            <span class="keyword">begin</span></span><br><span class="line">                               m = <span class="number">0</span>; </span><br><span class="line">                        <span class="comment">// 若松开，回到状态 0 ，等待下次按键到来</span></span><br><span class="line">                               cnt_m = <span class="number">0</span>;</span><br><span class="line">                            <span class="keyword">end</span></span><br><span class="line">                   <span class="keyword">end</span></span><br><span class="line">                   <span class="keyword">default</span> : m = <span class="number">1</span>; </span><br><span class="line">           <span class="keyword">endcase</span></span><br><span class="line">       <span class="keyword">end</span></span><br><span class="line">   <span class="keyword">end</span></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/************************************************/</span></span><br><span class="line"><span class="keyword">reg</span> [<span class="number">2</span>:<span class="number">0</span>]<span class="keyword">type</span>;</span><br><span class="line"><span class="comment">//00：时钟正常跑模式</span></span><br><span class="line"><span class="comment">//01：时钟调分模式,在该模式时间计数器停止计数</span></span><br><span class="line"><span class="comment">//10: 时钟调时模式，在该模式时间计数器停止计数</span></span><br><span class="line"><span class="comment">//11：闹钟调分模式，在该模式时间计数器正常计数</span></span><br><span class="line"><span class="comment">//100：闹钟调时模式，在该模式时间计数器正常计数</span></span><br><span class="line"><span class="comment">/************************************************/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk <span class="keyword">or</span> <span class="keyword">negedge</span> rst_n)</span><br><span class="line">    <span class="keyword">if</span>(!rst_n) </span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">        Display_Model &lt;= <span class="number">1'b0</span>;</span><br><span class="line">        a_add &lt;= <span class="number">1'b0</span>;</span><br><span class="line">        a_sub &lt;= <span class="number">1'b0</span>;</span><br><span class="line">        c_add &lt;= <span class="number">1'b0</span>;</span><br><span class="line">        c_sub &lt;= <span class="number">1'b0</span>;</span><br><span class="line">        Time_model &lt;= <span class="number">3'b000</span>;</span><br><span class="line">        <span class="keyword">type</span> &lt;= <span class="number">3'b000</span>;</span><br><span class="line">        cnt_control &lt;= <span class="number">1'b1</span>;<span class="comment">//启动计数</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">         <span class="keyword">if</span>(!model) </span><br><span class="line">            <span class="keyword">begin</span></span><br><span class="line">                <span class="keyword">if</span>(<span class="keyword">type</span> == <span class="number">3'b100</span>)</span><br><span class="line">                    <span class="keyword">type</span> = <span class="number">3'b000</span>;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    <span class="keyword">begin</span></span><br><span class="line">                        <span class="keyword">type</span> = <span class="keyword">type</span> + <span class="number">1'b1</span>;</span><br><span class="line">                    <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">case</span>(<span class="keyword">type</span>)</span><br><span class="line">        <span class="comment">//时钟正常开始跑</span></span><br><span class="line">            <span class="number">3'b000</span>:</span><br><span class="line">            <span class="keyword">begin</span></span><br><span class="line">                Time_model &lt;= <span class="number">3'b000</span>; </span><br><span class="line">                cnt_control &lt;= <span class="number">1'b1</span>;<span class="comment">//启动计数</span></span><br><span class="line">                Display_Model &lt;= <span class="number">1'b0</span>;</span><br><span class="line">                a_add &lt;= <span class="number">1'b0</span>;</span><br><span class="line">                a_sub &lt;= <span class="number">1'b0</span>;</span><br><span class="line">                c_add &lt;= <span class="number">1'b0</span>;</span><br><span class="line">                c_sub &lt;= <span class="number">1'b0</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            <span class="comment">//调分模式            </span></span><br><span class="line">            <span class="number">3'b001</span>:</span><br><span class="line">            <span class="keyword">begin</span> </span><br><span class="line">            cnt_control &lt;= <span class="number">1'b0</span>; <span class="comment">//关闭计数</span></span><br><span class="line">            Time_model &lt;= <span class="number">3'b001</span>;</span><br><span class="line">            Display_Model &lt;= <span class="number">1'b0</span>;</span><br><span class="line">                <span class="keyword">if</span>(!add)<span class="comment">//加</span></span><br><span class="line">                    <span class="keyword">begin</span></span><br><span class="line">                        c_add &lt;=<span class="number">1'b1</span> ;</span><br><span class="line">                    <span class="keyword">end</span></span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    <span class="keyword">begin</span></span><br><span class="line">                        c_add &lt;= <span class="number">1'b0</span>;</span><br><span class="line">                    <span class="keyword">end</span></span><br><span class="line">                    </span><br><span class="line">                 <span class="keyword">if</span>(!sub)<span class="comment">//减</span></span><br><span class="line">                    <span class="keyword">begin</span></span><br><span class="line">                        c_sub &lt;= <span class="number">1'b1</span>;</span><br><span class="line">                    <span class="keyword">end</span></span><br><span class="line">                 <span class="keyword">else</span></span><br><span class="line">                    <span class="keyword">begin</span></span><br><span class="line">                        c_sub &lt;= <span class="number">1'b0</span>;</span><br><span class="line">                    <span class="keyword">end</span></span><br><span class="line">               <span class="keyword">end</span></span><br><span class="line">            <span class="comment">//调时模式</span></span><br><span class="line">            <span class="number">3'b010</span>:</span><br><span class="line">            <span class="keyword">begin</span> </span><br><span class="line">             cnt_control &lt;= <span class="number">1'b0</span>;<span class="comment">//关闭计数</span></span><br><span class="line">             Time_model &lt;= <span class="number">2'b010</span>;</span><br><span class="line">             Display_Model &lt;= <span class="number">1'b0</span>;</span><br><span class="line">                <span class="keyword">if</span>(!add)<span class="comment">//加</span></span><br><span class="line">                    <span class="keyword">begin</span></span><br><span class="line">                        c_add &lt;=<span class="number">1'b1</span> ;</span><br><span class="line">                    <span class="keyword">end</span></span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    <span class="keyword">begin</span></span><br><span class="line">                        c_add &lt;= <span class="number">1'b0</span>;</span><br><span class="line">                    <span class="keyword">end</span></span><br><span class="line">                 <span class="keyword">if</span>(!sub)<span class="comment">//减</span></span><br><span class="line">                    <span class="keyword">begin</span></span><br><span class="line">                        c_sub &lt;= <span class="number">1'b1</span>;</span><br><span class="line">                    <span class="keyword">end</span></span><br><span class="line">                 <span class="keyword">else</span></span><br><span class="line">                    <span class="keyword">begin</span></span><br><span class="line">                        c_sub &lt;= <span class="number">1'b0</span>;</span><br><span class="line">                    <span class="keyword">end</span></span><br><span class="line">               <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">           <span class="comment">//调分模式            </span></span><br><span class="line">                       <span class="number">3'b011</span>:</span><br><span class="line">                       <span class="keyword">begin</span> </span><br><span class="line">                       cnt_control &lt;= <span class="number">1'b1</span>; <span class="comment">//kaijishu</span></span><br><span class="line">                       Time_model &lt;= <span class="number">3'b011</span>;</span><br><span class="line">                       Display_Model &lt;= <span class="number">1'b1</span>;</span><br><span class="line">                           <span class="keyword">if</span>(!add)<span class="comment">//加</span></span><br><span class="line">                               <span class="keyword">begin</span></span><br><span class="line">                                   a_add &lt;=<span class="number">1'b1</span> ;</span><br><span class="line">                               <span class="keyword">end</span></span><br><span class="line">                           <span class="keyword">else</span></span><br><span class="line">                               <span class="keyword">begin</span></span><br><span class="line">                                   a_add &lt;= <span class="number">1'b0</span>;</span><br><span class="line">                               <span class="keyword">end</span></span><br><span class="line">                            <span class="keyword">if</span>(!sub)<span class="comment">//减</span></span><br><span class="line">                               <span class="keyword">begin</span></span><br><span class="line">                                   a_sub &lt;= <span class="number">1'b1</span>;</span><br><span class="line">                               <span class="keyword">end</span></span><br><span class="line">                            <span class="keyword">else</span></span><br><span class="line">                               <span class="keyword">begin</span></span><br><span class="line">                                   a_sub &lt;= <span class="number">1'b0</span>;</span><br><span class="line">                               <span class="keyword">end</span></span><br><span class="line">                          <span class="keyword">end</span></span><br><span class="line">           </span><br><span class="line">                       <span class="comment">//调时模式</span></span><br><span class="line">                       <span class="number">3'b100</span>:</span><br><span class="line">                       <span class="keyword">begin</span> </span><br><span class="line">                        cnt_control &lt;= <span class="number">1'b1</span>;<span class="comment">//关闭计数</span></span><br><span class="line">                        Time_model &lt;= <span class="number">3'b100</span>;</span><br><span class="line">                        Display_Model &lt;= <span class="number">1'b1</span>;</span><br><span class="line">                        </span><br><span class="line">                           <span class="keyword">if</span>(!add)<span class="comment">//加</span></span><br><span class="line">                               <span class="keyword">begin</span></span><br><span class="line">                                   a_add &lt;=<span class="number">1'b1</span> ;</span><br><span class="line">                               <span class="keyword">end</span></span><br><span class="line">                           <span class="keyword">else</span></span><br><span class="line">                               <span class="keyword">begin</span></span><br><span class="line">                                   a_add &lt;= <span class="number">1'b0</span>;</span><br><span class="line">                               <span class="keyword">end</span></span><br><span class="line">                               </span><br><span class="line">                            <span class="keyword">if</span>(!sub)<span class="comment">//减</span></span><br><span class="line">                               <span class="keyword">begin</span></span><br><span class="line">                                   a_sub &lt;= <span class="number">1'b1</span>;</span><br><span class="line">                               <span class="keyword">end</span></span><br><span class="line">                            <span class="keyword">else</span></span><br><span class="line">                               <span class="keyword">begin</span></span><br><span class="line">                                   a_sub &lt;= <span class="number">1'b0</span>;</span><br><span class="line">                               <span class="keyword">end</span></span><br><span class="line">                          <span class="keyword">end</span>           </span><br><span class="line">         </span><br><span class="line">           <span class="keyword">default</span>:<span class="keyword">type</span> &lt;= <span class="number">3'b000</span>;</span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">   <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br><br></div>

<h3 id="时钟模块（clock）"><a href="#时钟模块（clock）" class="headerlink" title="时钟模块（clock）"></a>时钟模块（clock）</h3><table>
<thead>
<tr>
<th>输入</th>
<th style="text-align:left">功能说明</th>
<th style="text-align:center">输出</th>
<th style="text-align:center">功能说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>c_add</td>
<td style="text-align:left">加</td>
<td style="text-align:center">hour_h</td>
<td style="text-align:center">小时高位</td>
</tr>
<tr>
<td>c_sub</td>
<td style="text-align:left">减</td>
<td style="text-align:center">hour_l</td>
<td style="text-align:center">小时低位</td>
</tr>
<tr>
<td>Time_model</td>
<td style="text-align:left">模式控制端</td>
<td style="text-align:center">minute_h</td>
<td style="text-align:center">分钟高位</td>
</tr>
<tr>
<td>cot_control</td>
<td style="text-align:left">计数器开关</td>
<td style="text-align:center">minute_l</td>
<td style="text-align:center">分钟低位</td>
</tr>
<tr>
<td>clk</td>
<td style="text-align:left">时钟</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td>rst_n</td>
<td style="text-align:left">复位</td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<h4 id="细节讲解-1"><a href="#细节讲解-1" class="headerlink" title="细节讲解"></a>细节讲解</h4><p>时钟模块的输入都是来自键盘模块，所以输入不多说了，提一点，我的板子上的输入的时钟（clk），用的是50MHz晶振,而时钟是1Hz,也就是一秒走一下，所以内部必须分频，代码里注意看一下，我为了方便调试，分频并不是分频到1Hz，如果你有需要用到，修改里面的参数就好。</p>
<blockquote>
<p><strong>模块输出</strong></p>
</blockquote>
<p>模块的输出就是时钟的数据，是传给显示模块去驱动数码管显示的。<br>小时高位，0~2，三种情况，两根线[1:0]<br>小时低位，0~0，十种情况，四根线[3:0]<br>分钟高位，0~5，六种情况，三根线[2:0]<br>分钟低位，0~9，十种情况，四根线[3:0]</p>
<h4 id="代码展示-1"><a href="#代码展示-1" class="headerlink" title="代码展示"></a>代码展示</h4><p><button class="testButton" onclick="document.all.child2.style.display=(document.all.child2.style.display =='none')?'':'none'">点击显\隐代码</button></p>
<div id="child2" style="display:"><br><br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> clock(</span><br><span class="line">        <span class="keyword">input</span>  clk, </span><br><span class="line">        <span class="keyword">input</span>  rst_n,</span><br><span class="line">        <span class="keyword">input</span>  cnt_control, <span class="comment">//控制定时器 ,1启动 ，0停止</span></span><br><span class="line">        <span class="keyword">input</span>  c_add,       <span class="comment">//控制 加</span></span><br><span class="line">        <span class="keyword">input</span>  c_sub,       <span class="comment">//控制 减</span></span><br><span class="line">        <span class="keyword">input</span>  [<span class="number">2</span>:<span class="number">0</span>]Time_model,</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">output</span>  [<span class="number">1</span>:<span class="number">0</span>]hour_h,     <span class="comment">//小时 十位</span></span><br><span class="line">        <span class="keyword">output</span>  [<span class="number">3</span>:<span class="number">0</span>]hour_l,     <span class="comment">//小时 个位</span></span><br><span class="line">        <span class="keyword">output</span>  [<span class="number">2</span>:<span class="number">0</span>]minute_h,   <span class="comment">//分钟 十位</span></span><br><span class="line">        <span class="keyword">output</span>  [<span class="number">3</span>:<span class="number">0</span>]minute_l   <span class="comment">//分钟 个位</span></span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">parameter</span>  S= <span class="number">100000000</span>;</span><br><span class="line">    <span class="keyword">parameter</span>  M=<span class="number">60</span>;</span><br><span class="line">    <span class="comment">/*********************************************************/</span></span><br><span class="line">    <span class="comment">//1S计数器</span></span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">31</span>:<span class="number">0</span>] cnt1s;</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk <span class="keyword">or</span> <span class="keyword">negedge</span> rst_n)</span><br><span class="line">        <span class="keyword">if</span>(!rst_n) </span><br><span class="line">            cnt1s &lt;= <span class="number">15'd0</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>((cnt1s == S) || (!cnt_control)) </span><br><span class="line">                cnt1s &lt;= <span class="number">15'd0</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(cnt_control)</span><br><span class="line">                cnt1s &lt;= cnt1s + <span class="number">1'b1</span>; </span><br><span class="line">                </span><br><span class="line">    <span class="comment">/*********************************************************/</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">///////////////////////////////////////////////////////////</span></span><br><span class="line"> <span class="comment">//                        功能控制                        //</span></span><br><span class="line"> <span class="comment">//////////////////////////////////////////////////////////</span></span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">1</span>:<span class="number">0</span>]flag;<span class="comment">//用来标志reg1是否到了2，到了2,reg2只能加到4</span></span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">1</span>:<span class="number">0</span>] reg1;<span class="comment">//时的第一位：0~2</span></span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] reg2;</span><br><span class="line">  <span class="comment">//时的第二位：当第一位为0和1时，可以是0~9,当第一位为2时，只能是0~9,</span></span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">2</span>:<span class="number">0</span>] reg3;<span class="comment">//分的第一位：只能是0~5</span></span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] reg4;<span class="comment">//分的第二位：是0~9</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk <span class="keyword">or</span> <span class="keyword">negedge</span> rst_n)</span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(!rst_n)</span><br><span class="line">         <span class="keyword">begin</span></span><br><span class="line">            reg1 &lt;= <span class="number">2'd0</span>; <span class="comment">//小时 高位</span></span><br><span class="line">            reg2 &lt;= <span class="number">4'd0</span>; <span class="comment">//小时 低位</span></span><br><span class="line">            reg3 &lt;= <span class="number">3'd0</span>; <span class="comment">//分钟 高位</span></span><br><span class="line">            reg4 &lt;= <span class="number">4'd0</span>; <span class="comment">//分钟 低位</span></span><br><span class="line">            flag &lt;= <span class="number">2'd0</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">case</span>(Time_model)</span><br><span class="line">            <span class="comment">//时钟正常开始跑</span></span><br><span class="line">                <span class="number">3'b000</span>:</span><br><span class="line">                <span class="keyword">begin</span>    </span><br><span class="line">                    <span class="keyword">if</span>(cnt1s == S)  <span class="comment">//一分钟到了</span></span><br><span class="line">                    <span class="keyword">begin</span></span><br><span class="line">                        reg4 &lt;= reg4 + <span class="number">1'b1</span>;    </span><br><span class="line">                        <span class="keyword">if</span>(reg4 == <span class="number">4'd9</span>)        </span><br><span class="line">                        <span class="keyword">begin</span></span><br><span class="line">                            reg4 &lt;= <span class="number">4'd0</span>;</span><br><span class="line">                            reg3 &lt;= reg3 + <span class="number">1'b1</span>;</span><br><span class="line">                            </span><br><span class="line">                            <span class="keyword">if</span>(reg3 == <span class="number">3'd5</span>)    </span><br><span class="line">                            <span class="keyword">begin</span></span><br><span class="line">                                reg3 &lt;= <span class="number">3'd0</span>;        </span><br><span class="line">                                <span class="keyword">if</span>(reg1 == <span class="number">2'd2</span>)    </span><br><span class="line">                                    <span class="keyword">begin</span></span><br><span class="line">                                        reg2 &lt;= reg2 + <span class="number">1'b1</span>;</span><br><span class="line">                                        <span class="keyword">if</span>(reg2 == <span class="number">4'd3</span>)</span><br><span class="line">                                        <span class="keyword">begin</span></span><br><span class="line">                                            reg2 &lt;= <span class="number">4'd0</span>;                </span><br><span class="line">                                            reg1 &lt;= <span class="number">2'd0</span>;                            </span><br><span class="line">                                        <span class="keyword">end</span></span><br><span class="line">                                    <span class="keyword">end</span> </span><br><span class="line">                                <span class="keyword">else</span> </span><br><span class="line">                                    <span class="keyword">begin</span></span><br><span class="line">                                        reg2 &lt;= reg2 + <span class="number">1'b1</span>;</span><br><span class="line">                                        <span class="keyword">if</span>(reg2 == <span class="number">4'd9</span>)</span><br><span class="line">                                        <span class="keyword">begin</span></span><br><span class="line">                                        reg2 &lt;= <span class="number">4'd0</span>;</span><br><span class="line">                                        reg1 &lt;= reg1 + <span class="number">1'b1</span>;</span><br><span class="line">                                        <span class="keyword">end</span></span><br><span class="line">                                    <span class="keyword">end</span></span><br><span class="line">                             <span class="keyword">end</span></span><br><span class="line">                            </span><br><span class="line">                        <span class="keyword">end</span></span><br><span class="line">                    <span class="keyword">end</span></span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                </span><br><span class="line">                <span class="comment">//调分模式            </span></span><br><span class="line">                <span class="number">3'b001</span>:</span><br><span class="line">                <span class="keyword">begin</span> </span><br><span class="line">                    <span class="keyword">if</span>(c_add)<span class="comment">//加</span></span><br><span class="line">                    <span class="keyword">begin</span></span><br><span class="line">                        reg4 &lt;= reg4 + <span class="number">1'b1</span>;</span><br><span class="line">                        <span class="keyword">if</span>(reg4 == <span class="number">4'd9</span>)</span><br><span class="line">                        <span class="keyword">begin</span></span><br><span class="line">                            reg4 &lt;= <span class="number">4'd0</span>;</span><br><span class="line">                            reg3 &lt;= reg3 + <span class="number">1'b1</span>;</span><br><span class="line">                            <span class="keyword">if</span>(reg3 &gt; <span class="number">3'd5</span>)</span><br><span class="line">                                reg3 &lt;= <span class="number">3'd0</span>;</span><br><span class="line">                        <span class="keyword">end</span></span><br><span class="line">                    <span class="keyword">end</span></span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span>(c_sub)<span class="comment">//减</span></span><br><span class="line">                        <span class="keyword">begin</span></span><br><span class="line">                            reg4 &lt;= reg4 - <span class="number">1'b1</span>;</span><br><span class="line">                            <span class="keyword">if</span>(reg4 == <span class="number">4'd0</span>)</span><br><span class="line">                                <span class="keyword">begin</span></span><br><span class="line">                                    reg4 &lt;= <span class="number">4'd9</span>;</span><br><span class="line">                                    reg3 &lt;= reg3 - <span class="number">3'd1</span>;</span><br><span class="line">                                    <span class="keyword">if</span>(reg3 == <span class="number">3'd0</span>)</span><br><span class="line">                                        reg3 &lt;= <span class="number">3'd5</span>;</span><br><span class="line">                                <span class="keyword">end</span></span><br><span class="line">                        <span class="keyword">end</span></span><br><span class="line">                <span class="keyword">end</span>  </span><br><span class="line">                <span class="comment">//调时模式</span></span><br><span class="line">                <span class="number">3'b010</span>: </span><br><span class="line">                <span class="keyword">begin</span></span><br><span class="line">                    <span class="keyword">if</span>(c_add)<span class="comment">//加</span></span><br><span class="line">                    <span class="keyword">begin</span></span><br><span class="line">                        <span class="keyword">if</span>(flag == <span class="number">2'd2</span>)</span><br><span class="line">                        <span class="keyword">begin</span></span><br><span class="line">                            reg2 &lt;= reg2 + <span class="number">1'b1</span>;</span><br><span class="line">                            <span class="keyword">if</span>(reg2 &gt;= <span class="number">4'd3</span>)</span><br><span class="line">                            <span class="keyword">begin</span></span><br><span class="line">                                reg2 &lt;= <span class="number">4'd0</span>;</span><br><span class="line">                                reg1 &lt;= <span class="number">2'd0</span>;</span><br><span class="line">                                flag &lt;= <span class="number">2'd0</span>;</span><br><span class="line">                            <span class="keyword">end</span></span><br><span class="line">                        <span class="keyword">end</span></span><br><span class="line">                        <span class="keyword">else</span></span><br><span class="line">                        <span class="keyword">begin</span></span><br><span class="line">                            reg2 &lt;= reg2 + <span class="number">1'b1</span>;</span><br><span class="line">                            <span class="keyword">if</span>(reg2 == <span class="number">4'd9</span>)</span><br><span class="line">                            <span class="keyword">begin</span></span><br><span class="line">                                flag &lt;= flag + <span class="number">1'b1</span>;</span><br><span class="line">                                reg2 &lt;= <span class="number">4'd0</span>;</span><br><span class="line">                                reg1 &lt;= reg1 + <span class="number">1'b1</span>;         </span><br><span class="line">                            <span class="keyword">end</span></span><br><span class="line">                        <span class="keyword">end</span></span><br><span class="line">                    <span class="keyword">end</span></span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span>(c_sub)<span class="comment">//减</span></span><br><span class="line">                        <span class="keyword">begin</span></span><br><span class="line">                             <span class="keyword">if</span>(flag == <span class="number">2'd0</span>)</span><br><span class="line">                             <span class="keyword">begin</span></span><br><span class="line">                                 reg2 &lt;= reg2 - <span class="number">1'b1</span>;</span><br><span class="line">                                 <span class="keyword">if</span>(reg2 == <span class="number">4'd0</span>)</span><br><span class="line">                                 <span class="keyword">begin</span></span><br><span class="line">                                     reg2 &lt;= <span class="number">4'd3</span>;</span><br><span class="line">                                     reg1 &lt;= <span class="number">2'd2</span>;</span><br><span class="line">                                     flag &lt;= <span class="number">2'd2</span>;</span><br><span class="line">                                 <span class="keyword">end</span></span><br><span class="line">                             <span class="keyword">end</span></span><br><span class="line">                             <span class="keyword">else</span></span><br><span class="line">                             <span class="keyword">begin</span></span><br><span class="line">                                  reg2 &lt;= reg2 - <span class="number">1'b1</span>;</span><br><span class="line">                                  <span class="keyword">if</span>(reg2 == <span class="number">4'd0</span>)</span><br><span class="line">                                  <span class="keyword">begin</span></span><br><span class="line">                                      flag &lt;= flag - <span class="number">1'b1</span>;</span><br><span class="line">                                      reg1 &lt;= reg1 - <span class="number">1'b1</span>;   </span><br><span class="line">                                      reg2 &lt;= <span class="number">4'd9</span>;        </span><br><span class="line">                             <span class="keyword">end</span></span><br><span class="line">                       <span class="keyword">end</span></span><br><span class="line">                  <span class="keyword">end</span></span><br><span class="line">                <span class="keyword">end</span>    </span><br><span class="line">            <span class="keyword">endcase</span></span><br><span class="line">     <span class="keyword">end</span>       </span><br><span class="line">    <span class="comment">/************************************************/</span></span><br><span class="line">    <span class="keyword">assign</span> hour_h = reg1;</span><br><span class="line">    <span class="keyword">assign</span> hour_l = reg2;</span><br><span class="line">    <span class="keyword">assign</span> minute_h = reg3;</span><br><span class="line">    <span class="keyword">assign</span> minute_l = reg4;</span><br><span class="line">    <span class="comment">/************************************************/</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br><br></div> 

<h3 id="闹钟模块（alarm）"><a href="#闹钟模块（alarm）" class="headerlink" title="闹钟模块（alarm）"></a>闹钟模块（alarm）</h3><table>
<thead>
<tr>
<th>输入</th>
<th style="text-align:left">功能说明</th>
<th style="text-align:center">输出</th>
<th style="text-align:center">功能说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>a_hour</td>
<td style="text-align:left">闹钟小时控制</td>
<td style="text-align:center">a_hour_h</td>
<td style="text-align:center">闹钟小时高位</td>
</tr>
<tr>
<td>a_minute</td>
<td style="text-align:left">闹钟分钟控制</td>
<td style="text-align:center">a_hour_l</td>
<td style="text-align:center">闹钟小时低位</td>
</tr>
<tr>
<td>clk</td>
<td style="text-align:left">时钟</td>
<td style="text-align:center">a_minute_h</td>
<td style="text-align:center">闹钟分钟高位</td>
</tr>
<tr>
<td>rst_n</td>
<td style="text-align:left">复位</td>
<td style="text-align:center">a_minute_l</td>
<td style="text-align:center">闹钟分钟低位</td>
</tr>
</tbody>
</table>
<h4 id="细节讲解-2"><a href="#细节讲解-2" class="headerlink" title="细节讲解"></a>细节讲解</h4><p>闹钟模块与时钟模块的其实没什么区别，就是在调闹钟时，时钟正常运行，时钟调分，调时都会停止运行，也就是计数器不计数，其他的区别不大。</p>
<h4 id="代码展示-2"><a href="#代码展示-2" class="headerlink" title="代码展示"></a>代码展示</h4><p><button class="testButton" onclick="document.all.child3.style.display=(document.all.child3.style.display =='none')?'':'none'">点击显\隐代码</button></p>
<div id="child3" style="display:"><br><br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> alarm(</span><br><span class="line">        <span class="keyword">input</span>  clk, </span><br><span class="line">        <span class="keyword">input</span>  rst_n,</span><br><span class="line">        <span class="keyword">input</span>  c_add,       <span class="comment">//控制 加</span></span><br><span class="line">        <span class="keyword">input</span>  c_sub,       <span class="comment">//控制 减</span></span><br><span class="line">        <span class="keyword">input</span>  [<span class="number">2</span>:<span class="number">0</span>]Time_model,</span><br><span class="line"></span><br><span class="line">        <span class="keyword">output</span>  [<span class="number">1</span>:<span class="number">0</span>]a_hour_h,     <span class="comment">//闹钟小时 十位</span></span><br><span class="line">        <span class="keyword">output</span>  [<span class="number">3</span>:<span class="number">0</span>]a_hour_l,     <span class="comment">//闹钟小时 个位</span></span><br><span class="line">        <span class="keyword">output</span>  [<span class="number">2</span>:<span class="number">0</span>]a_minute_h,   <span class="comment">//闹钟分钟 十位</span></span><br><span class="line">        <span class="keyword">output</span>  [<span class="number">3</span>:<span class="number">0</span>]a_minute_l    <span class="comment">//闹钟分钟 个位</span></span><br><span class="line">    );</span><br><span class="line">    <span class="comment">//////////////////////////////////////////////////////////</span></span><br><span class="line"> <span class="comment">//                        功能控制                       //</span></span><br><span class="line"> <span class="comment">////////////////////////////////////////////////////////</span></span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">1</span>:<span class="number">0</span>]flag;<span class="comment">//用来标志reg1是否到了2，到了2,reg2只能加到4</span></span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">1</span>:<span class="number">0</span>] reg1;<span class="comment">//时的第一位：0~2</span></span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] reg2;</span><br><span class="line">  <span class="comment">//时的第二位：当第一位为0和1时，可以是0~9,当第一位为2时，只能是0~9,</span></span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">2</span>:<span class="number">0</span>] reg3;<span class="comment">//分的第一位：只能是0~5</span></span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] reg4;<span class="comment">//分的第二位：是0~9</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk <span class="keyword">or</span> <span class="keyword">negedge</span> rst_n)</span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(!rst_n)</span><br><span class="line">         <span class="keyword">begin</span></span><br><span class="line">            reg1 &lt;= <span class="number">2'd0</span>; <span class="comment">//闹钟小时 高位</span></span><br><span class="line">            reg2 &lt;= <span class="number">4'd0</span>; <span class="comment">//闹钟小时 低位</span></span><br><span class="line">            reg3 &lt;= <span class="number">3'd0</span>; <span class="comment">//闹钟分钟 高位</span></span><br><span class="line">            reg4 &lt;= <span class="number">4'd0</span>; <span class="comment">//闹钟分钟 低位</span></span><br><span class="line">            flag &lt;= <span class="number">2'd0</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">case</span>(Time_model)</span><br><span class="line">                <span class="comment">//闹钟调分模式            </span></span><br><span class="line">                <span class="number">3'b011</span>:</span><br><span class="line">                <span class="keyword">begin</span> </span><br><span class="line">                    <span class="keyword">if</span>(c_add)<span class="comment">//加</span></span><br><span class="line">                    <span class="keyword">begin</span></span><br><span class="line">                        reg4 &lt;= reg4 + <span class="number">1'b1</span>;</span><br><span class="line">                        <span class="keyword">if</span>(reg4 == <span class="number">4'd9</span>)</span><br><span class="line">                        <span class="keyword">begin</span></span><br><span class="line">                            reg4 &lt;= <span class="number">4'd0</span>;</span><br><span class="line">                            reg3 &lt;= reg3 + <span class="number">1'b1</span>;</span><br><span class="line">                            <span class="keyword">if</span>(reg3 &gt; <span class="number">3'd4</span>)</span><br><span class="line">                                reg3 &lt;= <span class="number">3'd0</span>;</span><br><span class="line">                        <span class="keyword">end</span></span><br><span class="line">                    <span class="keyword">end</span></span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span>(c_sub)<span class="comment">//减</span></span><br><span class="line">                        <span class="keyword">begin</span></span><br><span class="line">                            reg4 &lt;= reg4 - <span class="number">1'b1</span>;</span><br><span class="line">                            <span class="keyword">if</span>(reg4 == <span class="number">4'd0</span>)</span><br><span class="line">                                <span class="keyword">begin</span></span><br><span class="line">                                    reg4 &lt;= <span class="number">4'd9</span>;</span><br><span class="line">                                    reg3 &lt;= reg3 - <span class="number">3'd1</span>;</span><br><span class="line">                                    <span class="keyword">if</span>(reg3 == <span class="number">3'd0</span>)</span><br><span class="line">                                        reg3 &lt;= <span class="number">3'd5</span>;</span><br><span class="line">                                <span class="keyword">end</span></span><br><span class="line">                        <span class="keyword">end</span></span><br><span class="line">                <span class="keyword">end</span>  </span><br><span class="line">                <span class="comment">//闹钟调时模式</span></span><br><span class="line">                <span class="number">3'b100</span>: </span><br><span class="line">                <span class="keyword">begin</span></span><br><span class="line">                    <span class="keyword">if</span>(c_add)<span class="comment">//加</span></span><br><span class="line">                    <span class="keyword">begin</span></span><br><span class="line">                        <span class="keyword">if</span>(flag == <span class="number">2'd2</span>)</span><br><span class="line">                        <span class="keyword">begin</span></span><br><span class="line">                            reg2 &lt;= reg2 + <span class="number">1'b1</span>;</span><br><span class="line">                            <span class="keyword">if</span>(reg2 &gt;= <span class="number">4'd3</span>)</span><br><span class="line">                            <span class="keyword">begin</span></span><br><span class="line">                                reg2 &lt;= <span class="number">4'd0</span>;</span><br><span class="line">                                reg1 &lt;= <span class="number">2'd0</span>;</span><br><span class="line">                                flag &lt;= <span class="number">2'd0</span>;</span><br><span class="line">                            <span class="keyword">end</span></span><br><span class="line">                        <span class="keyword">end</span></span><br><span class="line">                        <span class="keyword">else</span></span><br><span class="line">                        <span class="keyword">begin</span></span><br><span class="line">                            reg2 &lt;= reg2 + <span class="number">1'b1</span>;</span><br><span class="line">                            <span class="keyword">if</span>(reg2 == <span class="number">4'd9</span>)</span><br><span class="line">                            <span class="keyword">begin</span></span><br><span class="line">                                flag &lt;= flag + <span class="number">1'b1</span>;</span><br><span class="line">                                reg2 &lt;= <span class="number">4'd0</span>;</span><br><span class="line">                                reg1 &lt;= reg1 + <span class="number">1'b1</span>;</span><br><span class="line">                                </span><br><span class="line">                            <span class="keyword">end</span></span><br><span class="line">                        <span class="keyword">end</span></span><br><span class="line">                    <span class="keyword">end</span></span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span>(c_sub)<span class="comment">//减</span></span><br><span class="line">                        <span class="keyword">begin</span></span><br><span class="line">                             <span class="keyword">if</span>(flag == <span class="number">2'd0</span>)</span><br><span class="line">                             <span class="keyword">begin</span></span><br><span class="line">                                 reg2 &lt;= reg2 - <span class="number">1'b1</span>;</span><br><span class="line">                                 <span class="keyword">if</span>(reg2 == <span class="number">4'd0</span>)</span><br><span class="line">                                 <span class="keyword">begin</span></span><br><span class="line">                                     reg2 &lt;= <span class="number">4'd3</span>;</span><br><span class="line">                                     reg1 &lt;= <span class="number">2'd2</span>;</span><br><span class="line">                                     flag &lt;= <span class="number">2'd2</span>;</span><br><span class="line">                                 <span class="keyword">end</span></span><br><span class="line">                             <span class="keyword">end</span></span><br><span class="line">                             <span class="keyword">else</span></span><br><span class="line">                             <span class="keyword">begin</span></span><br><span class="line">                                  reg2 &lt;= reg2 - <span class="number">1'b1</span>;</span><br><span class="line">                                  <span class="keyword">if</span>(reg2 == <span class="number">4'd0</span>)</span><br><span class="line">                                  <span class="keyword">begin</span></span><br><span class="line">                                      flag &lt;= flag - <span class="number">1'b1</span>;</span><br><span class="line">                                      reg1 &lt;= reg1 - <span class="number">1'b1</span>;                              </span><br><span class="line">                                      reg2 &lt;= <span class="number">4'd9</span>;                                    </span><br><span class="line">                             <span class="keyword">end</span></span><br><span class="line">                       <span class="keyword">end</span></span><br><span class="line">                  <span class="keyword">end</span></span><br><span class="line">                <span class="keyword">end</span>    </span><br><span class="line">            <span class="keyword">endcase</span></span><br><span class="line">     <span class="keyword">end</span>       </span><br><span class="line">    <span class="comment">/************************************************/</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">assign</span> a_hour_h = reg1;</span><br><span class="line">    <span class="keyword">assign</span> a_hour_l = reg2;</span><br><span class="line">    <span class="keyword">assign</span> a_minute_h = reg3;</span><br><span class="line">    <span class="keyword">assign</span> a_minute_l = reg4;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/************************************************/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br><br></div>



<h3 id="显示模块（display）"><a href="#显示模块（display）" class="headerlink" title="显示模块（display）"></a>显示模块（display）</h3><table>
<thead>
<tr>
<th>输入</th>
<th style="text-align:left">功能说明</th>
<th style="text-align:center">输出</th>
<th style="text-align:center">功能说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>a_hour_h</td>
<td style="text-align:left">闹钟小时高位</td>
<td style="text-align:center">data</td>
<td style="text-align:center">段选信号</td>
</tr>
<tr>
<td>a_hour_l</td>
<td style="text-align:left">闹钟小时低位</td>
<td style="text-align:center">select_wei</td>
<td style="text-align:center">位选信号</td>
</tr>
<tr>
<td>a_minute_h</td>
<td style="text-align:left">闹钟分钟高位</td>
<td style="text-align:center">beep</td>
<td style="text-align:center">蜂鸣器</td>
</tr>
<tr>
<td>a_minute_l</td>
<td style="text-align:left">闹钟分钟低位</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td>hour_h</td>
<td style="text-align:left">时钟小时高位</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td>hour_l</td>
<td style="text-align:left">时钟小时低位</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td>minute_h</td>
<td style="text-align:left">时钟分钟高位</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td>minute_l</td>
<td style="text-align:left">时钟分钟低位</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td>Display_Model</td>
<td style="text-align:left">显示模式控制</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td>clk</td>
<td style="text-align:left">时钟</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td>rst_n</td>
<td style="text-align:left">复位</td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<p>显示模块的输入有三种类型：</p>
<ol>
<li>闹钟的数据</li>
<li>时钟的数据</li>
<li>显示模式控制信号</li>
</ol>
<p>输出也只有三个</p>
<ol>
<li>data是八段数码管的段选信号，由于我没用小数点，所以七根线</li>
<li>select_wei数码管位选，四个数码管，四根线</li>
<li>beep链接蜂鸣器的，一根线。</li>
</ol>
<h4 id="细节讲解-3"><a href="#细节讲解-3" class="headerlink" title="细节讲解"></a>细节讲解</h4><p>显示模块里用到的主要是数码管动态扫描的知识，扫描频率如何设置，这些问题，查一下数码管的是如何显示就知道了，抓住段选和位选，还有动态扫描的原理，然后分清楚你使用的数码管是共阴还是共阳，这个显示模块就很好理解了。</p>
<h4 id="代码展示-3"><a href="#代码展示-3" class="headerlink" title="代码展示"></a>代码展示</h4><p><button class="testButton" onclick="document.all.child4.style.display=(document.all.child4.style.display =='none')?'':'none'">点击显\隐代码</button></p>
<div id="child4" style="display:"><br><br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span>  display(</span><br><span class="line">            <span class="keyword">input</span> clk,</span><br><span class="line">            <span class="keyword">input</span> rst_n,</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//时钟模式 双段选数据</span></span><br><span class="line">            <span class="keyword">input</span> [<span class="number">1</span>:<span class="number">0</span>] hour_h,</span><br><span class="line">            <span class="keyword">input</span> [<span class="number">3</span>:<span class="number">0</span>] hour_l,</span><br><span class="line">            <span class="keyword">input</span> [<span class="number">2</span>:<span class="number">0</span>] minute_h,</span><br><span class="line">            <span class="keyword">input</span> [<span class="number">3</span>:<span class="number">0</span>] minute_l,</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//闹钟模式 段选数据</span></span><br><span class="line">            <span class="keyword">input</span> [<span class="number">1</span>:<span class="number">0</span>] a_hour_h,</span><br><span class="line">            <span class="keyword">input</span> [<span class="number">3</span>:<span class="number">0</span>] a_hour_l,</span><br><span class="line">            <span class="keyword">input</span> [<span class="number">2</span>:<span class="number">0</span>] a_minute_h,</span><br><span class="line">            <span class="keyword">input</span> [<span class="number">3</span>:<span class="number">0</span>] a_minute_l,</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">input</span> Display_Model,<span class="comment">//0:时钟模式，1：秒表模式</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">output</span> [<span class="number">6</span>:<span class="number">0</span>] data,<span class="comment">//数码管段选</span></span><br><span class="line">            <span class="keyword">output</span> <span class="keyword">reg</span>[<span class="number">3</span>:<span class="number">0</span>] select_wei, <span class="comment">//数码管位选</span></span><br><span class="line">            <span class="keyword">output</span> <span class="keyword">reg</span> alarm_out</span><br><span class="line">                        );</span><br><span class="line"></span><br><span class="line"><span class="comment">/***********************************/</span></span><br><span class="line"><span class="keyword">parameter</span>     </span><br><span class="line">            SEG_0     = <span class="number">7'h7e</span>,<span class="comment">//c0,</span></span><br><span class="line">            SEG_1     = <span class="number">7'h30</span>,<span class="comment">//f9,</span></span><br><span class="line">            SEG_2     = <span class="number">7'h6d</span>,<span class="comment">//a4,</span></span><br><span class="line">            SEG_3     = <span class="number">7'h79</span>,<span class="comment">//b0,</span></span><br><span class="line">            SEG_4     = <span class="number">7'h33</span>,<span class="comment">//99,</span></span><br><span class="line">            SEG_5     = <span class="number">7'h5b</span>,<span class="comment">//92,</span></span><br><span class="line">            SEG_6     = <span class="number">7'h5f</span>,<span class="comment">//82,</span></span><br><span class="line">            SEG_7     = <span class="number">7'h70</span>,<span class="comment">//F8,</span></span><br><span class="line">            SEG_8     = <span class="number">7'h7f</span>,<span class="comment">//80,</span></span><br><span class="line">            SEG_9     = <span class="number">7'h7b</span>;<span class="comment">//90,</span></span><br><span class="line">        </span><br><span class="line">            <span class="comment">/***********************************/</span></span><br><span class="line">                        <span class="comment">//时钟数据编码        </span></span><br><span class="line">            <span class="comment">/***********************************/</span></span><br><span class="line"><span class="keyword">wire</span> [<span class="number">6</span>:<span class="number">0</span>]c_data1;</span><br><span class="line"><span class="keyword">wire</span> [<span class="number">6</span>:<span class="number">0</span>]c_data2;</span><br><span class="line"><span class="keyword">wire</span> [<span class="number">6</span>:<span class="number">0</span>]c_data3;</span><br><span class="line"><span class="keyword">wire</span> [<span class="number">6</span>:<span class="number">0</span>]c_data4;</span><br><span class="line"></span><br><span class="line"><span class="comment">//数码管一要显示的列表数据（0~2）</span></span><br><span class="line"><span class="keyword">reg</span> [<span class="number">6</span>:<span class="number">0</span>] data1_temp;</span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk <span class="keyword">or</span> <span class="keyword">negedge</span> rst_n)</span><br><span class="line">    <span class="keyword">if</span>(!rst_n)</span><br><span class="line">        data1_temp &lt;= SEG_0;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">case</span>(hour_h)</span><br><span class="line">            <span class="number">2'd0</span>:    data1_temp &lt;= SEG_0;</span><br><span class="line">            <span class="number">2'd1</span>:    data1_temp &lt;= SEG_1;</span><br><span class="line">            <span class="number">2'd2</span>:    data1_temp &lt;= SEG_2;</span><br><span class="line">            <span class="keyword">default</span>: data1_temp &lt;= SEG_0;</span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line"><span class="comment">/***********************************/</span></span><br><span class="line"><span class="comment">//数码管二要显示的列表数据（0~9）</span></span><br><span class="line"><span class="keyword">reg</span> [<span class="number">6</span>:<span class="number">0</span>] data2_temp;</span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk <span class="keyword">or</span> <span class="keyword">negedge</span> rst_n)</span><br><span class="line">    <span class="keyword">if</span>(!rst_n)</span><br><span class="line">        data2_temp &lt;= SEG_0;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">case</span>(hour_l)</span><br><span class="line">            <span class="number">4'd0</span>:    data2_temp &lt;= SEG_0;</span><br><span class="line">            <span class="number">4'd1</span>:    data2_temp &lt;= SEG_1;</span><br><span class="line">            <span class="number">4'd2</span>:    data2_temp &lt;= SEG_2;</span><br><span class="line">            <span class="number">4'd3</span>:    data2_temp &lt;= SEG_3;</span><br><span class="line">            <span class="number">4'd4</span>:    data2_temp &lt;= SEG_4;</span><br><span class="line">            <span class="number">4'd5</span>:    data2_temp &lt;= SEG_5;</span><br><span class="line">            <span class="number">4'd6</span>:    data2_temp &lt;= SEG_6;</span><br><span class="line">            <span class="number">4'd7</span>:    data2_temp &lt;= SEG_7;</span><br><span class="line">            <span class="number">4'd8</span>:    data2_temp &lt;= SEG_8;</span><br><span class="line">            <span class="number">4'd9</span>:    data2_temp &lt;= SEG_9;</span><br><span class="line">            <span class="keyword">default</span>: data2_temp &lt;= SEG_0;</span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line"><span class="comment">/***********************************/</span></span><br><span class="line"><span class="comment">//数码管三要显示的列表数据 (0~5)</span></span><br><span class="line"><span class="keyword">reg</span> [<span class="number">6</span>:<span class="number">0</span>] data3_temp;</span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk <span class="keyword">or</span> <span class="keyword">negedge</span> rst_n)</span><br><span class="line">    <span class="keyword">if</span>(!rst_n)</span><br><span class="line">        data3_temp &lt;= SEG_0;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">case</span>(minute_h)</span><br><span class="line">            <span class="number">3'd0</span>:    data3_temp &lt;= SEG_0;</span><br><span class="line">            <span class="number">3'd1</span>:    data3_temp &lt;= SEG_1;</span><br><span class="line">            <span class="number">3'd2</span>:    data3_temp &lt;= SEG_2;</span><br><span class="line">            <span class="number">3'd3</span>:    data3_temp &lt;= SEG_3;</span><br><span class="line">            <span class="number">3'd4</span>:    data3_temp &lt;= SEG_4;</span><br><span class="line">            <span class="number">3'd5</span>:    data3_temp &lt;= SEG_5;</span><br><span class="line">            <span class="keyword">default</span>: data3_temp &lt;= SEG_0;</span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line"><span class="comment">/***********************************/</span></span><br><span class="line"><span class="comment">//数码管四要显示的列表数据（1~9）</span></span><br><span class="line"><span class="keyword">reg</span> [<span class="number">6</span>:<span class="number">0</span>] data4_temp;</span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk <span class="keyword">or</span> <span class="keyword">negedge</span> rst_n)</span><br><span class="line">    <span class="keyword">if</span>(!rst_n)</span><br><span class="line">        data4_temp &lt;= SEG_0;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">case</span>(minute_l)</span><br><span class="line">            <span class="number">4'd0</span>:    data4_temp &lt;= SEG_0;</span><br><span class="line">            <span class="number">4'd1</span>:    data4_temp &lt;= SEG_1;</span><br><span class="line">            <span class="number">4'd2</span>:    data4_temp &lt;= SEG_2;</span><br><span class="line">            <span class="number">4'd3</span>:    data4_temp &lt;= SEG_3;</span><br><span class="line">            <span class="number">4'd4</span>:    data4_temp &lt;= SEG_4;</span><br><span class="line">            <span class="number">4'd5</span>:    data4_temp &lt;= SEG_5;</span><br><span class="line">            <span class="number">4'd6</span>:    data4_temp &lt;= SEG_6;</span><br><span class="line">            <span class="number">4'd7</span>:    data4_temp &lt;= SEG_7;</span><br><span class="line">            <span class="number">4'd8</span>:    data4_temp &lt;= SEG_8;</span><br><span class="line">            <span class="number">4'd9</span>:    data4_temp &lt;= SEG_9;</span><br><span class="line">            <span class="keyword">default</span>: data4_temp &lt;= SEG_0;</span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line"><span class="comment">/*****************************************/</span></span><br><span class="line"><span class="keyword">assign</span> c_data1 = data1_temp;</span><br><span class="line"><span class="keyword">assign</span> c_data2 = data2_temp;</span><br><span class="line"><span class="keyword">assign</span> c_data3 = data3_temp;</span><br><span class="line"><span class="keyword">assign</span> c_data4 = data4_temp;</span><br><span class="line"><span class="comment">/*****************************************/</span></span><br><span class="line">        </span><br><span class="line">            <span class="comment">/***********************************/</span></span><br><span class="line">                        <span class="comment">//闹钟数据编码        </span></span><br><span class="line">            <span class="comment">/***********************************/</span></span><br><span class="line"><span class="keyword">wire</span> [<span class="number">6</span>:<span class="number">0</span>]a_data1;</span><br><span class="line"><span class="keyword">wire</span> [<span class="number">6</span>:<span class="number">0</span>]a_data2;</span><br><span class="line"><span class="keyword">wire</span> [<span class="number">6</span>:<span class="number">0</span>]a_data3;</span><br><span class="line"><span class="keyword">wire</span> [<span class="number">6</span>:<span class="number">0</span>]a_data4;</span><br><span class="line"><span class="comment">//数码管一要显示的列表数据（0~5）</span></span><br><span class="line"><span class="keyword">reg</span> [<span class="number">6</span>:<span class="number">0</span>] a_data1_temp;</span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk <span class="keyword">or</span> <span class="keyword">negedge</span> rst_n)</span><br><span class="line">    <span class="keyword">if</span>(!rst_n) </span><br><span class="line">        a_data1_temp &lt;= SEG_0;</span><br><span class="line">    <span class="keyword">else</span>  </span><br><span class="line">        <span class="keyword">case</span>(a_hour_h)</span><br><span class="line">            <span class="number">3'd0</span>:    a_data1_temp &lt;= SEG_0;</span><br><span class="line">            <span class="number">3'd1</span>:    a_data1_temp &lt;= SEG_1;</span><br><span class="line">            <span class="number">3'd2</span>:    a_data1_temp &lt;= SEG_2;</span><br><span class="line">            <span class="number">3'd3</span>:    a_data1_temp &lt;= SEG_3;</span><br><span class="line">            <span class="number">3'd4</span>:    a_data1_temp &lt;= SEG_4;</span><br><span class="line">            <span class="number">3'd5</span>:    a_data1_temp &lt;= SEG_5;</span><br><span class="line">            <span class="keyword">default</span>: a_data1_temp &lt;= SEG_0;</span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line"><span class="comment">/***********************************/</span></span><br><span class="line"><span class="comment">//数码管二要显示的列表数据（0~9）</span></span><br><span class="line"><span class="keyword">reg</span> [<span class="number">6</span>:<span class="number">0</span>] a_data2_temp;</span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk <span class="keyword">or</span> <span class="keyword">negedge</span> rst_n)</span><br><span class="line">    <span class="keyword">if</span>(!rst_n) </span><br><span class="line">        a_data2_temp &lt;= SEG_0;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">case</span>(a_hour_l)</span><br><span class="line">            <span class="number">4'd0</span>:    a_data2_temp &lt;= SEG_0;</span><br><span class="line">            <span class="number">4'd1</span>:    a_data2_temp &lt;= SEG_1;</span><br><span class="line">            <span class="number">4'd2</span>:    a_data2_temp &lt;= SEG_2;</span><br><span class="line">            <span class="number">4'd3</span>:    a_data2_temp &lt;= SEG_3;</span><br><span class="line">            <span class="number">4'd4</span>:    a_data2_temp &lt;= SEG_4;</span><br><span class="line">            <span class="number">4'd5</span>:    a_data2_temp &lt;= SEG_5;</span><br><span class="line">            <span class="number">4'd6</span>:    a_data2_temp &lt;= SEG_6;</span><br><span class="line">            <span class="number">4'd7</span>:    a_data2_temp &lt;= SEG_7;</span><br><span class="line">            <span class="number">4'd8</span>:    a_data2_temp &lt;= SEG_8;</span><br><span class="line">            <span class="number">4'd9</span>:    a_data2_temp &lt;= SEG_9;</span><br><span class="line">            <span class="keyword">default</span>: a_data2_temp &lt;= SEG_0;</span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line"><span class="comment">/*****************************************/</span></span><br><span class="line"><span class="comment">//数码管三要显示的列表数据（0~9）</span></span><br><span class="line"><span class="keyword">reg</span> [<span class="number">6</span>:<span class="number">0</span>] a_data3_temp;        </span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk <span class="keyword">or</span> <span class="keyword">negedge</span> rst_n)</span><br><span class="line">    <span class="keyword">if</span>(!rst_n) </span><br><span class="line">        a_data3_temp &lt;= SEG_0;</span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">        <span class="keyword">case</span>(a_minute_h)</span><br><span class="line">            <span class="number">4'd0</span>:    a_data3_temp &lt;= SEG_0;</span><br><span class="line">            <span class="number">4'd1</span>:    a_data3_temp &lt;= SEG_1;</span><br><span class="line">            <span class="number">4'd2</span>:    a_data3_temp &lt;= SEG_2;</span><br><span class="line">            <span class="number">4'd3</span>:    a_data3_temp &lt;= SEG_3;</span><br><span class="line">            <span class="number">4'd4</span>:    a_data3_temp &lt;= SEG_4;</span><br><span class="line">            <span class="number">4'd5</span>:    a_data3_temp &lt;= SEG_5;</span><br><span class="line">            <span class="number">4'd6</span>:    a_data3_temp &lt;= SEG_6;</span><br><span class="line">            <span class="number">4'd7</span>:    a_data3_temp &lt;= SEG_7;</span><br><span class="line">            <span class="number">4'd8</span>:    a_data3_temp &lt;= SEG_8;</span><br><span class="line">            <span class="number">4'd9</span>:    a_data3_temp &lt;= SEG_9;</span><br><span class="line">            <span class="keyword">default</span>: a_data3_temp &lt;= SEG_0;</span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line"><span class="comment">/***********************************/</span></span><br><span class="line"><span class="comment">//数码管四要显示的列表数据（0~9）</span></span><br><span class="line"><span class="keyword">reg</span> [<span class="number">6</span>:<span class="number">0</span>] a_data4_temp;</span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk <span class="keyword">or</span> <span class="keyword">negedge</span> rst_n)</span><br><span class="line">    <span class="keyword">if</span>(!rst_n) </span><br><span class="line">        a_data4_temp &lt;= SEG_0;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">case</span>(a_minute_l)</span><br><span class="line">            <span class="number">4'd0</span>:    a_data4_temp &lt;= SEG_0;</span><br><span class="line">            <span class="number">4'd1</span>:    a_data4_temp &lt;= SEG_1;</span><br><span class="line">            <span class="number">4'd2</span>:    a_data4_temp &lt;= SEG_2;</span><br><span class="line">            <span class="number">4'd3</span>:    a_data4_temp &lt;= SEG_3;</span><br><span class="line">            <span class="number">4'd4</span>:    a_data4_temp &lt;= SEG_4;</span><br><span class="line">            <span class="number">4'd5</span>:    a_data4_temp &lt;= SEG_5;</span><br><span class="line">            <span class="number">4'd6</span>:    a_data4_temp &lt;= SEG_6;</span><br><span class="line">            <span class="number">4'd7</span>:    a_data4_temp &lt;= SEG_7;</span><br><span class="line">            <span class="number">4'd8</span>:    a_data4_temp &lt;= SEG_8;</span><br><span class="line">            <span class="number">4'd9</span>:    a_data4_temp &lt;= SEG_9;</span><br><span class="line">            <span class="keyword">default</span>: a_data4_temp &lt;= SEG_0;</span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line"><span class="comment">/*******************************************************/</span>    </span><br><span class="line"><span class="keyword">assign</span> a_data1 = a_data1_temp;</span><br><span class="line"><span class="keyword">assign</span> a_data2 = a_data2_temp;</span><br><span class="line"><span class="keyword">assign</span> a_data3 = a_data3_temp;</span><br><span class="line"><span class="keyword">assign</span> a_data4 = a_data4_temp;</span><br><span class="line"><span class="comment">/***************************************************/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/******************************************/</span></span><br><span class="line"><span class="keyword">parameter</span> shuaxin = <span class="number">17'h1ffff</span>;</span><br><span class="line"><span class="comment">// 数码管扫描频率</span></span><br><span class="line"><span class="keyword">reg</span> [<span class="number">19</span>:<span class="number">0</span>] cnt;    </span><br><span class="line"><span class="keyword">reg</span> [<span class="number">1</span>:<span class="number">0</span>] num;<span class="comment">//每隔5MS，num加1</span></span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk <span class="keyword">or</span> <span class="keyword">negedge</span> rst_n)</span><br><span class="line">    <span class="keyword">if</span>(!rst_n) </span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">        select_wei &lt;= <span class="number">4'd8</span>; <span class="comment">// 1000</span></span><br><span class="line">        cnt &lt;= <span class="number">18'd0</span>;</span><br><span class="line">        num &lt;= <span class="number">2'd0</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(cnt == shuaxin) </span><br><span class="line">            <span class="keyword">begin</span></span><br><span class="line">                num &lt;= num + <span class="number">1'b1</span>;</span><br><span class="line">                cnt &lt;= <span class="number">18'd0</span>;</span><br><span class="line">                <span class="keyword">if</span>(select_wei == <span class="number">4'd1</span>) <span class="comment">//0001</span></span><br><span class="line">                     select_wei &lt;= <span class="number">4'd8</span>;</span><br><span class="line">                 <span class="keyword">else</span></span><br><span class="line">              select_wei &lt;= &#123;<span class="number">1'b0</span>,select_wei[<span class="number">3</span>:<span class="number">1</span>]&#125;;   <span class="comment">//右移</span></span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">         <span class="keyword">else</span></span><br><span class="line">              cnt &lt;= cnt + <span class="number">1'b1</span>;</span><br><span class="line"><span class="comment">/******************************************/</span></span><br><span class="line"><span class="comment">//通过Display_Model来确定是要送秒表数据还是闹钟的数据</span></span><br><span class="line"><span class="keyword">reg</span> [<span class="number">7</span>:<span class="number">0</span>] data_temp;</span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk <span class="keyword">or</span> <span class="keyword">negedge</span> rst_n)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span>(!rst_n)</span><br><span class="line">        data_temp &lt;= <span class="number">7'h7e</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(cnt == shuaxin) </span><br><span class="line">        <span class="keyword">case</span>(num)</span><br><span class="line">            <span class="number">2'd0</span>:    data_temp &lt;= Display_Model ? a_data1:c_data1;<span class="comment">//给第一个数码管送数据</span></span><br><span class="line">            <span class="number">2'd1</span>:    data_temp &lt;= Display_Model ? a_data2:c_data2;<span class="comment">//给第二个数码管送数据</span></span><br><span class="line">            <span class="number">2'd2</span>:    data_temp &lt;= Display_Model ? a_data3:c_data3;<span class="comment">//给第二个数码管送数据</span></span><br><span class="line">            <span class="number">2'd3</span>:    data_temp &lt;= Display_Model ? a_data4:c_data4;<span class="comment">//给第二个数码管送数据</span></span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">assign</span> data = data_temp;</span><br><span class="line"><span class="comment">/******************************************/</span>   </span><br><span class="line"></span><br><span class="line">  <span class="comment">//////        比较器模块             //////</span></span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk <span class="keyword">or</span> <span class="keyword">negedge</span> rst_n)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span>(!rst_n)</span><br><span class="line">        alarm_out &lt;= <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(a_data1 == c_data1 &amp;&amp; a_data2 == c_data2 &amp;&amp; a_data3 == c_data3 &amp;&amp; a_data4 == c_data4)</span><br><span class="line">            alarm_out &lt;=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            alarm_out&lt;=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br><br></div>



<h2 id="top层"><a href="#top层" class="headerlink" title="top层"></a>top层</h2><p>主要是链接，直接上代码吧。</p>
<h4 id="代码展示-4"><a href="#代码展示-4" class="headerlink" title="代码展示"></a>代码展示</h4><p><button class="testButton" onclick="document.all.child5.style.display=(document.all.child5.style.display =='none')?'':'none'">点击显\隐代码</button></p>
<div id="child5" style="display:"><br><br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">module</span> top(</span><br><span class="line">            <span class="keyword">input</span> clk,</span><br><span class="line">            <span class="keyword">input</span> rst_n,</span><br><span class="line">           </span><br><span class="line">            <span class="keyword">input</span> add_in,</span><br><span class="line">            <span class="keyword">input</span> sub_in,</span><br><span class="line">            <span class="keyword">input</span> model_in,</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">output</span> [<span class="number">6</span>:<span class="number">0</span>] data,<span class="comment">//数码管段选数据</span></span><br><span class="line">            <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] select_wei, <span class="comment">//数码管位选</span></span><br><span class="line">            <span class="keyword">output</span>  alarm_out</span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line">           );</span><br><span class="line"></span><br><span class="line"><span class="keyword">wire</span> [<span class="number">1</span>:<span class="number">0</span>] hour_h;</span><br><span class="line"><span class="keyword">wire</span> [<span class="number">3</span>:<span class="number">0</span>] hour_l;</span><br><span class="line"><span class="keyword">wire</span> [<span class="number">2</span>:<span class="number">0</span>] minute_h;</span><br><span class="line"><span class="keyword">wire</span> [<span class="number">3</span>:<span class="number">0</span>] minute_l;</span><br><span class="line"></span><br><span class="line"><span class="keyword">wire</span> [<span class="number">1</span>:<span class="number">0</span>] a_hour_h;</span><br><span class="line"><span class="keyword">wire</span> [<span class="number">3</span>:<span class="number">0</span>] a_hour_l;</span><br><span class="line"><span class="keyword">wire</span> [<span class="number">2</span>:<span class="number">0</span>] a_minute_h;</span><br><span class="line"><span class="keyword">wire</span> [<span class="number">3</span>:<span class="number">0</span>] a_minute_l;</span><br><span class="line"></span><br><span class="line"><span class="keyword">wire</span> Display_Model;</span><br><span class="line"><span class="keyword">wire</span> [<span class="number">2</span>:<span class="number">0</span>]Time_model;</span><br><span class="line"></span><br><span class="line"><span class="keyword">wire</span> c_add;</span><br><span class="line"><span class="keyword">wire</span> c_sub;</span><br><span class="line"></span><br><span class="line"><span class="keyword">wire</span> a_add; </span><br><span class="line"><span class="keyword">wire</span> a_sub;</span><br><span class="line"><span class="keyword">wire</span> cnt_control; <span class="comment">//控制定时器</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">key       U1(</span><br><span class="line">        <span class="comment">//top的input</span></span><br><span class="line">          <span class="variable">.clk</span>(clk),</span><br><span class="line">          <span class="variable">.rst_n</span>(rst_n), </span><br><span class="line">          </span><br><span class="line">          <span class="variable">.add_in</span>(add_in),</span><br><span class="line">          <span class="variable">.sub_in</span>(sub_in),</span><br><span class="line">          <span class="variable">.model_in</span>(model_in),</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//连clock的线</span></span><br><span class="line">          <span class="variable">.cnt_control</span>(cnt_control),</span><br><span class="line">          <span class="variable">.c_add</span>(c_add),</span><br><span class="line">          <span class="variable">.c_sub</span>(c_sub),</span><br><span class="line">          <span class="variable">.Time_model</span>(Time_model),</span><br><span class="line">          </span><br><span class="line">        <span class="comment">//连alarm的线</span></span><br><span class="line">           <span class="variable">.a_add</span>(a_add),</span><br><span class="line">           <span class="variable">.a_sub</span>(a_sub),</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//连display的线</span></span><br><span class="line">           <span class="variable">.Display_Model</span>(Display_Model)        </span><br><span class="line">           );</span><br><span class="line">                   </span><br><span class="line">clock       U2(</span><br><span class="line">        <span class="comment">//input</span></span><br><span class="line">              <span class="variable">.clk</span>(clk),</span><br><span class="line">              <span class="variable">.rst_n</span>(rst_n),</span><br><span class="line">              </span><br><span class="line">        <span class="comment">//从key来的线</span></span><br><span class="line">              <span class="variable">.c_add</span>(c_add),</span><br><span class="line">              <span class="variable">.c_sub</span>(c_sub),</span><br><span class="line">              <span class="variable">.cnt_control</span>(cnt_control),</span><br><span class="line">              <span class="variable">.Time_model</span>(Time_model),</span><br><span class="line">         </span><br><span class="line">        <span class="comment">//output     </span></span><br><span class="line">        <span class="comment">//连display的线</span></span><br><span class="line">        </span><br><span class="line">              <span class="variable">.hour_h</span>(hour_h),</span><br><span class="line">              <span class="variable">.hour_l</span>(hour_l),</span><br><span class="line">              <span class="variable">.minute_h</span>(minute_h),</span><br><span class="line">              <span class="variable">.minute_l</span>(minute_l)</span><br><span class="line">                      </span><br><span class="line">            );</span><br><span class="line">alarm           U3(</span><br><span class="line">                    <span class="comment">//input</span></span><br><span class="line">                          <span class="variable">.clk</span>(clk),</span><br><span class="line">                          <span class="variable">.rst_n</span>(rst_n),</span><br><span class="line">                          </span><br><span class="line">                    <span class="comment">//从key来的线</span></span><br><span class="line">                          <span class="variable">.c_add</span>(a_add),</span><br><span class="line">                          <span class="variable">.c_sub</span>(a_sub),              </span><br><span class="line">                          <span class="variable">.Time_model</span>(Time_model),</span><br><span class="line">                     </span><br><span class="line">                    <span class="comment">//output     </span></span><br><span class="line">                    <span class="comment">//连display的线</span></span><br><span class="line">                    </span><br><span class="line">                          <span class="variable">.a_hour_h</span>(a_hour_h),</span><br><span class="line">                          <span class="variable">.a_hour_l</span>(a_hour_l),</span><br><span class="line">                          <span class="variable">.a_minute_h</span>(a_minute_h),</span><br><span class="line">                          <span class="variable">.a_minute_l</span>(a_minute_l)</span><br><span class="line">                                  </span><br><span class="line">                        );</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">                    </span><br><span class="line">display             U4(</span><br><span class="line">                        <span class="comment">//input </span></span><br><span class="line">                        <span class="variable">.clk</span>(clk),</span><br><span class="line">                        <span class="variable">.rst_n</span>(rst_n),</span><br><span class="line">                        </span><br><span class="line">                        <span class="comment">//从clock 来的线</span></span><br><span class="line">                        <span class="variable">.hour_h</span>(hour_h),</span><br><span class="line">                        <span class="variable">.hour_l</span>(hour_l),</span><br><span class="line">                        <span class="variable">.minute_h</span>(minute_h),</span><br><span class="line">                        <span class="variable">.minute_l</span>(minute_l),</span><br><span class="line">                        </span><br><span class="line">                        <span class="comment">//从alarm 来的线</span></span><br><span class="line">                        <span class="variable">.a_hour_h</span>(a_hour_h),</span><br><span class="line">                        <span class="variable">.a_hour_l</span>(a_hour_l),</span><br><span class="line">                        <span class="variable">.a_minute_h</span>(a_minute_h),</span><br><span class="line">                        <span class="variable">.a_minute_l</span>(a_minute_l),</span><br><span class="line">                       </span><br><span class="line">                        <span class="comment">//从key 来的线</span></span><br><span class="line">                        <span class="variable">.Display_Model</span>(Display_Model),</span><br><span class="line">                        </span><br><span class="line">                        <span class="comment">//output </span></span><br><span class="line">                        <span class="variable">.data</span>(data),</span><br><span class="line">                        <span class="variable">.select_wei</span>(select_wei),</span><br><span class="line">                        <span class="variable">.alarm_out</span>(alarm_out)</span><br><span class="line">                        );</span><br><span class="line">                 </span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br><br></div>

<h4 id="细节讲解-4"><a href="#细节讲解-4" class="headerlink" title="细节讲解"></a>细节讲解</h4><p>top层的作用是连接各个模块，列出系统的输入输出，然后分清楚中间节点，如果之前没有写过top层，可以先从试着写个小系统，比如：全加器（调用半加器实现），如果你已经是老司机，相信已经驾轻就熟了，不多说了。其实，我这个例化写得有点烦了，例化如果非要分写法可以分为两种，我这是比较烦的，不过我也不改了，╭(╯^╰)╮</p>
<h2 id="写在后面的话"><a href="#写在后面的话" class="headerlink" title="写在后面的话"></a>写在后面的话</h2><p>数字钟就讲诉到这里，整个系统不难理解，只是模块之间的联系必须弄清楚，我的观点是：把需要的模块列出来，分析模块之间的联系，再具体看各个模块的内容，单个验证，自顶向下设计，主要还是多琢磨吧，有耐心就好。</p>
<p>关于文章，如果有任何问题都可以在评论区和我交流，如果有错误，欢迎斧正，谢谢了~~</p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/搞硬件/">搞硬件</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/FPGA/">FPGA</a></li></ul>

      
        <div id="donation_div"></div>

<script src="/js/vdonate.js"></script>
<script>
var a = new Donate({
  title: '我们一起来让这个世界有趣一点……', // 可选参数，打赏标题
  btnText: '打赏支持', // 可选参数，打赏按钮文字
  el: document.getElementById('donation_div'),
  wechatImage: 'https://raw.githubusercontent.com/sirlh/photo/master/wechatpay.png',
  alipayImage: 'https://raw.githubusercontent.com/sirlh/photo/master/alipay.jpg'
});
</script>
      
            
      
        
	<div id="comment">
		<!-- 来必力City版安装代码 -->
		<div id="lv-container" data-id="city" data-uid="MTAyMC8yOTQ4MS82MDQ5">
		<script type="text/javascript">
		   (function(d, s) {
		       var j, e = d.getElementsByTagName(s)[0];

		       if (typeof LivereTower === 'function') { return; }

		       j = d.createElement(s);
		       j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
		       j.async = true;

		       e.parentNode.insertBefore(j, e);
		   })(document, 'script');
		</script>
		<noscript>为正常使用来必力评论功能请激活JavaScript</noscript>
		</div>
		<!-- City版安装代码已完成 -->
	</div>


      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/01/06/FPGA-避障游戏/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">上一篇</strong>
      <div class="article-nav-title">
        
          FPGA.避障游戏
        
      </div>
    </a>
  
  
    <a href="/2017/11/09/matlab实现快速傅里叶变换/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">下一篇</strong>
      <div class="article-nav-title">matlab实现快速傅里叶变换</div>
    </a>
  
</nav>

  
</article>

<!-- Table of Contents -->

  <aside id="sidebar">
    <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    
      <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#功能描述"><span class="nav-number">1.</span> <span class="nav-text">功能描述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#整体设计图"><span class="nav-number">2.</span> <span class="nav-text">整体设计图</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#模块讲解"><span class="nav-number">3.</span> <span class="nav-text">模块讲解</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#键盘模块（key）"><span class="nav-number">3.1.</span> <span class="nav-text">键盘模块（key）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#细节讲解"><span class="nav-number">3.1.1.</span> <span class="nav-text">细节讲解</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#代码展示"><span class="nav-number">3.1.2.</span> <span class="nav-text">代码展示</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#时钟模块（clock）"><span class="nav-number">3.2.</span> <span class="nav-text">时钟模块（clock）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#细节讲解-1"><span class="nav-number">3.2.1.</span> <span class="nav-text">细节讲解</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#代码展示-1"><span class="nav-number">3.2.2.</span> <span class="nav-text">代码展示</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#闹钟模块（alarm）"><span class="nav-number">3.3.</span> <span class="nav-text">闹钟模块（alarm）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#细节讲解-2"><span class="nav-number">3.3.1.</span> <span class="nav-text">细节讲解</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#代码展示-2"><span class="nav-number">3.3.2.</span> <span class="nav-text">代码展示</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#显示模块（display）"><span class="nav-number">3.4.</span> <span class="nav-text">显示模块（display）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#细节讲解-3"><span class="nav-number">3.4.1.</span> <span class="nav-text">细节讲解</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#代码展示-3"><span class="nav-number">3.4.2.</span> <span class="nav-text">代码展示</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#top层"><span class="nav-number">4.</span> <span class="nav-text">top层</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#代码展示-4"><span class="nav-number">4.0.1.</span> <span class="nav-text">代码展示</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#细节讲解-4"><span class="nav-number">4.0.2.</span> <span class="nav-text">细节讲解</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#写在后面的话"><span class="nav-number">5.</span> <span class="nav-text">写在后面的话</span></a></li></ol>
    
    </div>
  </aside>
</section>
        
      </div>
      <footer id="footer" class="site-footer">
  

  <div class="clearfix container">
      <div class="site-info">
	      &copy; 2018 luheng&#39;s blog All Rights Reserved.
          
            <span id="busuanzi_container_site_uv">
              本站访客数<span id="busuanzi_value_site_uv"></span>人次  
              本站总访问量<span id="busuanzi_value_site_pv"></span>次
            </span>
          
      </div>
  </div>
</footer>


<!-- min height -->

<script>
    var contentdiv = document.getElementById("content");

    contentdiv.style.minHeight = document.body.offsetHeight - document.getElementById("allheader").offsetHeight - document.getElementById("footer").offsetHeight + "px";
</script>

<!-- Custome JS -->
<script src="/js/my.js"></script>
    </div>
    <!-- <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/tags" class="mobile-nav-link">Tags</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
    <a href="/guestbook" class="mobile-nav-link">guestbook</a>
  
    <a href="/atom.xml" class="mobile-nav-link">rss</a>
  
</nav> -->
    

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/scripts.js"></script>
<script src="/js/bootstrap.js"></script>
<script src="/js/main.js"></script>







  <div style="display: none;">
    <script src="https://s95.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
  </div>



	<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
	</script>






  </div>

  <a id="rocket" href="#top" class=""></a>
  <script type="text/javascript" src="/js/totop.js" async=""></script>
</body>
</html>
